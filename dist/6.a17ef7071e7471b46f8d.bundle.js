(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{522:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});n(63);var a=n(40),i=(n(516),n(520)),o=(n(518),n(12)),r=(n(64),n(39)),l=(n(31),n(10)),c=(n(41),n(19)),s=(n(473),n(472)),u=n(0),f=n.n(u),p=n(11),d=n(28),m=n.n(d),h=n(33),b=n(463),y=n.n(b);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){w(e,t,n[t])})}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function k(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var C=s.a.Dragger,N={name:"file",multiple:!0,action:"/api/upload/static-files",onChange:function(e){var t=e.file.status;"uploading"!==t&&console.log(e.file,e.fileList),"done"===t?c.a.success("".concat(e.file.name," file uploaded successfully.")):"error"===t&&c.a.error("".concat(e.file.name," file upload failed."))}},x=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=k(this,O(t).call(this,e))).state={files:[],visible:!1,pagination:{},loading:!1,clipboard:null},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,u["Component"]),function(e,t,n){t&&E(e.prototype,t),n&&E(e,n)}(t,[{key:"getTableColums",value:function(){var e=this;return[{title:"原始文件名",dataIndex:"originalName"},{title:"文件名",dataIndex:"fileName"},{title:"创建时间",dataIndex:"createdAt",render:function(e,t){return Object(h.a)(t.createdAt,"YYYY-MM-DD")}},{title:"文件类型",dataIndex:"mimetype",width:160},{title:"文件大小",dataIndex:"size",render:function(e,t){return(t.size/1024).toFixed(1)+"k"}},{title:"文件路径",dataIndex:"filePath"},{title:"操作",key:"operation",width:200,render:function(t,n){return f.a.createElement("div",null,f.a.createElement(l.a,{type:"primary",size:"small",title:"复制","data-clipboard-text":n.filePath+n.fileName,className:"btnCopy"},"复制url"),",",f.a.createElement(r.a,{title:"确认要删除？",onConfirm:function(){return e.deleteFile(n._id)},okText:"确定",cancelText:"取消"},f.a.createElement(l.a,{type:"danger",size:"small",title:"删除"},f.a.createElement("i",{className:"fa fa-trash-o fa-fw"}),"删除")))}}]}},{key:"deleteFile",value:function(e){var t=this;p.a.delete("/files/"+e).then(function(){c.a.success("删除文件成功"),t.fetchData()})}},{key:"fetchData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;this.setState({loading:!0});var a={limit:n,page:t};return p.a.get("/files?"+m.a.stringify(a)).then(function(t){var n=JSON.parse(t.headers["x-paging"]),a=v({},e.state.pagination);a.total=n.total,console.log(n.total),e.setState({files:t.data,loading:!1,pagination:a})})}},{key:"handleOk",value:function(){var e=this;return this.fetchData(this.props.location).then(function(){e.setState({visible:!1})})}},{key:"handleTableChange",value:function(e){var t=v({},this.state.pagination);console.log(e),t.current=e.current,this.setState({pagination:t}),this.fetchData(e.current,e.pageSize)}},{key:"componentDidMount",value:function(){var e=new y.a(".btnCopy");this.setState({clipboard:e}),e.on("success",function(e){c.a.success("复制链接成功")}),this.fetchData()}},{key:"componentWillUnmount",value:function(){this.state.clipboard.destroy()}},{key:"render",value:function(){var e=this,t={onChange:function(e,t){console.log("selectedRowKeys: ".concat(e),"selectedRows: ",t)},getCheckboxProps:function(e){return{disabled:"Disabled User"===e.key,name:e.name}}};return f.a.createElement("div",{className:"main-content"},f.a.createElement("div",{className:"manager-tip"},f.a.createElement("i",{className:"fa fa-edit fa-fw"}),f.a.createElement("strong",null,"控制台----静态文件管理")),f.a.createElement("div",{className:"panel"},f.a.createElement(l.a,{type:"primary",onClick:function(){return e.setState({visible:!0})}},f.a.createElement("i",{className:"fa fa-plus-square fa-fw"}," "),"添加静态文件"),f.a.createElement(l.a,{type:"danger"},f.a.createElement("i",{className:"fa fa-fw fa-trash-o fa-fw"}," "),"批量删除")),f.a.createElement(i.a,{title:"上传静态文件",visible:this.state.visible,onOk:function(){return e.handleOk()},onCancel:function(){return e.setState({visible:!1})}},f.a.createElement(C,N,f.a.createElement("p",{className:"ant-upload-drag-icon"},f.a.createElement(o.a,{type:"inbox"})),f.a.createElement("p",{className:"ant-upload-text"},"Click or drag file to this area to upload"),f.a.createElement("p",{className:"ant-upload-hint"},"Support for a single or bulk upload. Strictly prohibit from uploading company data or other band files"))),f.a.createElement("div",{className:"table-wrapper"},f.a.createElement(a.a,{rowKey:function(e){return e._id},rowSelection:t,columns:this.getTableColums(),dataSource:this.state.files,pagination:this.state.pagination,loading:this.state.loading,onChange:function(t){return e.handleTableChange(t)}})))}}]),t}()}}]);