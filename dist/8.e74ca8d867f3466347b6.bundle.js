(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{534:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return x});a(65);var n=a(40),i=(a(527),a(531)),o=(a(529),a(11)),r=(a(66),a(39)),l=(a(32),a(9)),c=(a(43),a(22)),s=(a(428),a(427)),u=a(0),f=a.n(u),p=a(12),d=a(27),m=a.n(d),h=a(33),b=a(406),y=a.n(b);function g(e){return(g="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){w(e,t,a[t])})}return e}function w(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function E(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e,t){return!t||"object"!==g(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var C=s.a.Dragger,N={name:"file",multiple:!0,action:"/api/upload/static-files",onChange:function(e){var t=e.file.status;"uploading"!==t&&console.log(e.file,e.fileList),"done"===t?c.a.success("".concat(e.file.name," file uploaded successfully.")):"error"===t&&c.a.error("".concat(e.file.name," file upload failed."))}},x=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=k(this,O(t).call(this,e))).state={files:[],visible:!1,pagination:{},loading:!1,clipboard:null},a}var a,s,d;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,u["Component"]),a=t,(s=[{key:"getTableColums",value:function(){var e=this;return[{title:"\u539f\u59cb\u6587\u4ef6\u540d",dataIndex:"originalName"},{title:"\u6587\u4ef6\u540d",dataIndex:"fileName"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createdAt",width:120,render:function(e,t){return Object(h.a)(t.createdAt,"YYYY-MM-DD")}},{title:"\u6587\u4ef6\u7c7b\u578b",dataIndex:"mimetype",width:160},{title:"\u6587\u4ef6\u5927\u5c0f",dataIndex:"size",width:80,render:function(e,t){return(t.size/1024).toFixed(1)+"k"}},{title:"\u64cd\u4f5c",key:"operation",width:200,render:function(t,a){return f.a.createElement("div",null,f.a.createElement(l.a,{type:"primary",size:"small",title:"\u590d\u5236","data-clipboard-text":a.filePath+a.fileName,className:"btnCopy"},"\u590d\u5236url"),",",f.a.createElement(r.a,{title:"\u786e\u8ba4\u8981\u5220\u9664\uff1f",onConfirm:function(){return e.deleteFile(a._id)},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},f.a.createElement(l.a,{type:"danger",size:"small",title:"\u5220\u9664"},f.a.createElement("i",{className:"fa fa-trash-o fa-fw"}),"\u5220\u9664")))}}]}},{key:"deleteFile",value:function(e){var t=this;p.a.delete("/files/"+e).then(function(){c.a.success("\u5220\u9664\u6587\u4ef6\u6210\u529f"),t.fetchData()})}},{key:"fetchData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;this.setState({loading:!0});var n={limit:a,page:t};return p.a.get("/files?"+m.a.stringify(n)).then(function(t){var a=JSON.parse(t.headers["x-paging"]),n=v({},e.state.pagination);n.total=a.total,console.log(a.total),e.setState({files:t.data,loading:!1,pagination:n})})}},{key:"handleOk",value:function(){var e=this;return this.fetchData(this.props.location).then(function(){e.setState({visible:!1})})}},{key:"handleTableChange",value:function(e){var t=v({},this.state.pagination);console.log(e),t.current=e.current,this.setState({pagination:t}),this.fetchData(e.current,e.pageSize)}},{key:"componentDidMount",value:function(){var e=new y.a(".btnCopy");this.setState({clipboard:e}),e.on("success",function(e){c.a.success("\u590d\u5236\u94fe\u63a5\u6210\u529f")}),this.fetchData()}},{key:"componentWillUnmount",value:function(){this.state.clipboard.destroy()}},{key:"render",value:function(){var e=this,t={onChange:function(e,t){console.log("selectedRowKeys: ".concat(e),"selectedRows: ",t)},getCheckboxProps:function(e){return{disabled:"Disabled User"===e.key,name:e.name}}};return f.a.createElement("div",{className:"main-content"},f.a.createElement("div",{className:"manager-tip"},f.a.createElement("i",{className:"fa fa-edit fa-fw"}),f.a.createElement("strong",null,"\u63a7\u5236\u53f0----\u9759\u6001\u6587\u4ef6\u7ba1\u7406")),f.a.createElement("div",{className:"panel"},f.a.createElement(l.a,{type:"primary",onClick:function(){return e.setState({visible:!0})}},f.a.createElement("i",{className:"fa fa-plus-square fa-fw"},"\xa0"),"\u6dfb\u52a0\u9759\u6001\u6587\u4ef6"),f.a.createElement(l.a,{type:"danger"},f.a.createElement("i",{className:"fa fa-fw fa-trash-o fa-fw"},"\xa0"),"\u6279\u91cf\u5220\u9664")),f.a.createElement(i.a,{title:"\u4e0a\u4f20\u9759\u6001\u6587\u4ef6",visible:this.state.visible,onOk:function(){return e.handleOk()},onCancel:function(){return e.setState({visible:!1})}},f.a.createElement(C,N,f.a.createElement("p",{className:"ant-upload-drag-icon"},f.a.createElement(o.a,{type:"inbox"})),f.a.createElement("p",{className:"ant-upload-text"},"Click or drag file to this area to upload"),f.a.createElement("p",{className:"ant-upload-hint"},"Support for a single or bulk upload. Strictly prohibit from uploading company data or other band files"))),f.a.createElement("div",{className:"table-wrapper"},f.a.createElement(n.a,{rowKey:function(e){return e._id},rowSelection:t,columns:this.getTableColums(),dataSource:this.state.files,pagination:this.state.pagination,loading:this.state.loading,onChange:function(t){return e.handleTableChange(t)}})))}}])&&E(a.prototype,s),d&&E(a,d),t}()}}]);