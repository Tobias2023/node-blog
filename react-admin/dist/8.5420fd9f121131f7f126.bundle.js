(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{528:function(e,t,a){"use strict";a.r(t);a(65);var n=a(38),r=(a(63),a(27)),i=(a(521),a(525)),o=(a(523),a(10)),l=(a(43),a(23)),s=(a(66),a(37)),c=(a(30),a(9)),f=(a(422),a(421)),u=(a(76),a(26)),m=a(0),p=a.n(m),d=a(13),h=a(28),y=a.n(h),g=a(31),b=a(400),v=a.n(b),w=a(389);function E(e){return(E="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){k(e,t,a[t])})}return e}function k(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function S(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function C(e,t){return!t||"object"!==E(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e,t){return(D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var x=u.a.Item,F=f.a.Dragger,I=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=C(this,O(t).call(this,e))).state={files:[],visible:!1,pagination:{},loading:!1,clipboard:null,isShowNewFolderDialog:!1,folderName:""},a}var a,f,h;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}(t,m["Component"]),a=t,(f=[{key:"getTableColums",value:function(){var e=this;return[{title:"\u539f\u59cb\u6587\u4ef6\u540d",dataIndex:"originalName",render:function(e,t){return t.isdir?p.a.createElement(w.a,{to:"/blog/admin/demos/static-files/"+t._id},p.a.createElement("span",null,p.a.createElement("i",{className:"fa fa-folder fa-fw"}),t.originalName)):3===t.category?p.a.createElement("span",null,p.a.createElement("i",{className:"fa fa-photo fa-fw"}),t.originalName):p.a.createElement("span",null,p.a.createElement("i",{className:"fa fa-file fa-fw"}),t.originalName)}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createdAt",width:200,render:function(e,t){return Object(g.a)(t.createdAt,"YYYY-MM-DD hh:mm")}},{title:"\u6587\u4ef6\u7c7b\u578b",dataIndex:"mimetype",width:160,render:function(e,t){return t.mimetype?t.mimetype:"-"}},{title:"\u6587\u4ef6\u5927\u5c0f",dataIndex:"size",width:100,render:function(e,t){return t.size?(t.size/1024).toFixed(1)+"k":"-"}},{title:"\u64cd\u4f5c",key:"operation",width:200,render:function(t,a){return p.a.createElement("div",null,!a.isdir&&p.a.createElement(c.a,{type:"primary",size:"small",title:"\u590d\u5236","data-clipboard-text":a.filePath+a.fileName,className:"btnCopy",style:{marginRight:"5px"}},"\u590d\u5236url"),p.a.createElement(s.a,{title:"\u786e\u8ba4\u8981\u5220\u9664\uff1f",onConfirm:function(){return e.deleteFile(a._id)},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},p.a.createElement(c.a,{type:"danger",size:"small",title:"\u5220\u9664"},p.a.createElement("i",{className:"fa fa-trash-o fa-fw"}),"\u5220\u9664")))}}]}},{key:"deleteFile",value:function(e){var t=this;d.a.delete("/files/"+e).then(function(){l.a.success("\u5220\u9664\u6587\u4ef6\u6210\u529f"),t.fetchData()})}},{key:"fetchData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;this.setState({loading:!0});var n={limit:a,page:t,parentId:this.props.match.params.folderId};return d.a.get("/files?"+y.a.stringify(n)).then(function(t){var a=N({},e.state.pagination);a.total=t.data.totalCount,e.setState({files:t.data.items,loading:!1,pagination:a})})}},{key:"fetchFolderName",value:function(){var e=this,t=this.props.match.params.folderId;if(t)return d.a.get("/files/getFolderName/"+t).then(function(t){return e.setState({folderName:t.data.originalName})})}},{key:"createFolder",value:function(e){var t=this;return d.a.post("/files/createFolder",{name:e}).then(function(){l.a.success("\u521b\u5efa\u6587\u4ef6\u5939\u6210\u529f\uff01"),t.fetchData(),t.setState({isShowNewFolderDialog:!1})})}},{key:"handleOk",value:function(){var e=this;return this.fetchData().then(function(){e.setState({visible:!1})})}},{key:"handleNewFloderOk",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields(function(e,a){e||t.createFolder(a.name)})}},{key:"handleTableChange",value:function(e){var t=N({},this.state.pagination);t.current=e.current,this.setState({pagination:t}),this.fetchData(e.current,e.pageSize)}},{key:"componentDidMount",value:function(){var e=new v.a(".btnCopy");this.setState({clipboard:e}),e.on("success",function(e){l.a.success("\u590d\u5236\u94fe\u63a5\u6210\u529f")}),this.fetchData(),this.fetchFolderName()}},{key:"componentDidUpdate",value:function(e){e.match.params.folderId!==this.props.match.params.folderId&&(this.fetchData(),this.fetchFolderName())}},{key:"componentWillUnmount",value:function(){this.state.clipboard.destroy()}},{key:"render",value:function(){var e=this,t={onChange:function(e,t){console.log("selectedRowKeys: ".concat(e),"selectedRows: ",t)},getCheckboxProps:function(e){return{disabled:"Disabled User"===e.key,name:e.name}}},a={name:"file",multiple:!0,action:"/api/upload/static-files?parentId="+(this.props.match.params.folderId||""),onChange:function(e){var t=e.file.status;"uploading"!==t&&console.log(e.file,e.fileList),"done"===t?l.a.success("".concat(e.file.name," file uploaded successfully.")):"error"===t&&l.a.error("".concat(e.file.name," file upload failed."))}},s=this.props.form.getFieldDecorator;return p.a.createElement("div",{className:"main-content"},p.a.createElement("div",{className:"manager-tip"},p.a.createElement("i",{className:"fa fa-edit fa-fw"}),p.a.createElement("strong",null,"\u63a7\u5236\u53f0----\u9759\u6001\u6587\u4ef6\u7ba1\u7406")),p.a.createElement("div",{className:"panel"},p.a.createElement(c.a,{type:"primary",onClick:function(){return e.setState({visible:!0})}},p.a.createElement("i",{className:"fa fa-arrow-up fa-fw"},"\xa0"),"\u4e0a\u4f20"),this.props.match.params.folderId?"":p.a.createElement(c.a,{type:"primary",onClick:function(){return e.setState({isShowNewFolderDialog:!0})}},p.a.createElement("i",{className:"fa fa-plus-square fa-fw"},"\xa0"),"\u65b0\u5efa\u6587\u4ef6\u5939"),p.a.createElement(c.a,{type:"danger"},p.a.createElement("i",{className:"fa fa-fw fa-trash-o fa-fw"},"\xa0"),"\u6279\u91cf\u5220\u9664"),this.props.match.params.folderId&&p.a.createElement(p.a.Fragment,null,p.a.createElement("span",{style:{marginLeft:"20px"}},"\u5f53\u524d\u76ee\u5f55\u4e3a\uff1a",this.state.folderName),p.a.createElement(w.a,{style:{marginLeft:"10px",color:"#fff",backgroundColor:"#1890ff",padding:"3px 8px",borderRadius:"2px"},to:"/blog/admin/demos/static-files"},"\u8fd4\u56de\u4e0a\u4e00\u7ea7"))),p.a.createElement(i.a,{title:"\u4e0a\u4f20\u6587\u4ef6",visible:this.state.visible,onOk:function(){return e.handleOk()},onCancel:function(){return e.setState({visible:!1})}},p.a.createElement(F,a,p.a.createElement("p",{className:"ant-upload-drag-icon"},p.a.createElement(o.a,{type:"inbox"})),p.a.createElement("p",{className:"ant-upload-text"},"Click or drag file to this area to upload"),p.a.createElement("p",{className:"ant-upload-hint"},"Support for a single or bulk upload. Strictly prohibit from uploading company data or other band files"))),p.a.createElement(i.a,{title:"\u65b0\u5efa\u6587\u4ef6\u5939",visible:this.state.isShowNewFolderDialog,onCancel:function(){return e.setState({isShowNewFolderDialog:!1})},footer:null},p.a.createElement(u.a,{onSubmit:function(t){return e.handleNewFloderOk(t)}},p.a.createElement(x,{labelCol:{span:6},wrapperCol:{span:10},label:"\u6587\u4ef6\u5939\u540d\u79f0\uff1a"},s("name",{rules:[{required:!0,message:"\u6587\u4ef6\u5939\u540d\u79f0\u957f\u5ea6\u8981\u57281-25\u4e2a\u5b57\u7b26\u4e4b\u95f4\uff01",min:1,max:25}],initialValue:null})(p.a.createElement(r.a,{type:"text",width:"100%"}))),p.a.createElement(x,{labelCol:{span:6},wrapperCol:{span:10},label:"\u64cd\u4f5c\uff1a"},p.a.createElement(c.a,{type:"primary",htmlType:"submit"},"\u65b0\u5efa")))),p.a.createElement("div",{className:"table-wrapper"},p.a.createElement(n.a,{rowKey:function(e){return e._id},rowSelection:t,columns:this.getTableColums(),dataSource:this.state.files,pagination:this.state.pagination,loading:this.state.loading,onChange:function(t){return e.handleTableChange(t)}})))}}])&&S(a.prototype,f),h&&S(a,h),t}();t.default=u.a.create()(I)}}]);